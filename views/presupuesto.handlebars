<div class="container">
  <h1>Presupuesto OT: {{ot.Deal_Name}}</h1>
  <p><strong>Código OT:</strong> {{ot.C_digo}}</p>
  <p><strong>Cliente:</strong> {{ot.Account_Name.name}}</p>

  {{#each puntos_de_venta}}
    <hr>
    <h2>PDV: {{PDV_relacionados.name}}</h2>

    {{#each escaparates}}
      <h3>Escaparate: {{Nombre_del_escaparate}} ({{Tipo_de_escaparate}})</h3>
      <table>
        <thead>
          <tr>
            <th>Foto</th>
            <th>Concepto</th>
            <th>Alto</th>
            <th>Ancho</th>
            <th>Material</th>
            <th>Precio/M.Prima</th>
            <th>Precio Unitario</th>
            <th>Unidades</th>
            <th>Total</th>
            <th>Escaparate</th>
            <th>Total</th>
            <th>Montaje</th>
            <th>Editar</th>
          </tr>
        </thead>
        <tbody>
          {{#each (range 1 10)}}
            {{#with (concat "Elemento" this) as |elKey|}}
              {{#if (lookup ../.. this.[elKey])}}
              <tr>
                <td>
                  <input type="text" value="{{lookup ../../lineas.[0] 'Fotos'}}">
                </td>
                <td>
                  <select>
                    <option selected>{{lookup ../../this (concat "Elemento" this)}}</option>
                    <!-- Otras opciones las añadirás más tarde -->
                  </select>
                </td>
                <td>
                  <input type="number" value="{{lookup ../../this (concat "ALT" this)}}">
                </td>
                <td>
                  <input type="number" value="{{lookup ../../this (concat "ANC" this)}}">
                </td>
                <td>
                  <select>
                    <option selected>{{lookup ../../this (concat "Material" this)}}</option>
                    <!-- Otras opciones las añadirás más tarde -->
                  </select>
                </td>
                <td>
                  <input type="number" class="precio-mp" step="any">
                </td>
                <td>
                  <input type="number" class="precio-unitario" step="any">
                </td>
                <td>
                  <input type="number" value="{{lookup ../../this (concat "UD" this)}}">
                </td>
                <td>
                  <input type="number" class="total-elemento" readonly>
                </td>
                <td>{{../Nombre_del_escaparate}}</td>
                <td>
                  <input type="number" class="total-escaparate" readonly>
                </td>
                <td>
                  <input type="number" class="montaje" step="any">
                </td>
                <td>
                  <button class="guardar-escaparate">💾</button>
                </td>
              </tr>
              {{/if}}
            {{/with}}
          {{/each}}
        </tbody>
      </table>
    {{/each}}

    <!-- NUEVO ESCAPARATE -->
    <h4>Crear nuevo escaparate</h4>
    <table>
      <thead>
        <tr>
          <th>Foto</th>
          <th>Concepto</th>
          <th>Alto</th>
          <th>Ancho</th>
          <th>Material</th>
          <th>Precio/M.Prima</th>
          <th>Precio Unitario</th>
          <th>Unidades</th>
          <th>Total</th>
          <th>Escaparate</th>
          <th>Total</th>
          <th>Montaje</th>
          <th>Guardar</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><input type="text" placeholder="URL Foto"></td>
          <td>
            <select>
              <option value="">-- Seleccionar --</option>
            </select>
          </td>
          <td><input type="number" placeholder="Alto"></td>
          <td><input type="number" placeholder="Ancho"></td>
          <td>
            <select>
              <option value="">-- Seleccionar --</option>
            </select>
          </td>
          <td><input type="number" class="precio-mp" step="any"></td>
          <td><input type="number" class="precio-unitario" step="any"></td>
          <td><input type="number" placeholder="UD"></td>
          <td><input type="number" class="total-elemento" readonly></td>
          <td><input type="text" placeholder="Nombre escaparate"></td>
          <td><input type="number" class="total-escaparate" readonly></td>
          <td><input type="number" class="montaje" step="any"></td>
          <td><button class="guardar-nuevo-escaparate">💾</button></td>
        </tr>
      </tbody>
    </table>
  {{/each}}

  <br><br>
  <div style="text-align: center;">
    <button id="generar-pdf">Generar PDF final</button>
  </div>
</div>
